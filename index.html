<script>
    const depositForm = document.getElementById('deposit-form');
    const amountInput = document.getElementById('amount');
    const nameInput = document.getElementById('name');
    const totalAmountSpan = document.getElementById('total-amount');
    const historyList = document.getElementById('history-list');
    const audio = document.getElementById('background-audio');

    let totalAmount = 320810; // Monto inicial actualizado
    totalAmountSpan.textContent = `$${totalAmount}`; // Mostrar sin decimales

    // Intentar reproducir el audio al enfocar el formulario
    depositForm.addEventListener('focus', () => {
        audio.play().catch(error => {
            console.log("Error al intentar reproducir el audio al enfocar el formulario:", error);
        });
    }, true);

    // Función para actualizar el total
    function updateTotal(amount) {
        totalAmount += amount;
        totalAmountSpan.textContent = `$${totalAmount}`; // Sin decimales
    }

    // Función para desplazarse automáticamente hacia el final de la lista
    function scrollToBottom() {
        historyList.scrollTop = historyList.scrollHeight; // Desplaza al final
    }

    // Función para añadir un depósito al historial
    function addDeposit(name, amount) {
        const listItem = document.createElement('li');
        listItem.innerHTML = `
            ${name} depositó $${amount} el ${new Date().toLocaleDateString()}
            <button class="delete-button">Eliminar</button>
        `;
        const deleteButton = listItem.querySelector('.delete-button');
        deleteButton.addEventListener('click', () => {
            historyList.removeChild(listItem);
            updateTotal(-amount); // Resta el monto eliminado
        });
        historyList.appendChild(listItem);

        // Desplazarse automáticamente al final después de añadir el depósito
        scrollToBottom();
    }

    // Manejo del formulario
    depositForm.addEventListener('submit', (event) => {
        event.preventDefault();
        const name = nameInput.value.trim();
        const amount = parseInt(amountInput.value); // Convertir a entero

        if (!name || isNaN(amount) || amount <= 0) {
            alert('Por favor, ingresa un nombre y un monto válido.');
            return;
        }

        addDeposit(name, amount);
        updateTotal(amount);

        // Reproducir el audio automáticamente después de añadir un depósito
        audio.play().catch(error => {
            console.log("Error al intentar reproducir el audio después de añadir un depósito:", error);
        });

        // Limpiar campos
        nameInput.value = '';
        amountInput.value = '';
    });
</script>
